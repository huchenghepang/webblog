import{bS as Rt,l as ye,aJ as qt,a0 as we,Z as Pe,j as J,d as g,f as x,h as ee,k as z,J as Ee,af as w,g as te,p as A,i as U,F as ge,q as ht,s as E,aD as Kt,bK as vt,bT as mt,ai as Se,v as _e,H as he,u as ae,a2 as Te,a5 as gt,bU as Ot,r as V,z as jt,ap as yt,P as Ke,am as et,at as Wt,Q as tt,bV as at,a8 as Ve,aj as Zt,S as bt,T as me,bW as Gt,B as Xt,a as nt,w as pe,D as ve,aL as Ct,bX as Yt,bY as _t,bZ as Be,b_ as Le,b$ as Jt,o as We,ah as O,c0 as Ae,c1 as wt,aG as kt,bH as Qt,V as ea,c2 as st,c3 as ta,W as aa,X as na,a4 as sa,a6 as oa,a7 as la,c4 as ra,an as ia,c5 as ua,aa as ca,a9 as da,c6 as pa,c7 as fa,x as $e,y as ot,aQ as ha,G as h,aA as va,Y as ma,ar as ga,ag as Nt,be as Oe,al as lt,I as Et,A as ya,n as ba,c8 as Ca,bD as _a,b1 as wa,aS as ka,b6 as Na,bj as Ea,aV as X,L as Sa,aF as Va,ba as Ia,bb as $a,bg as Aa,bi as Ta,_ as Ba}from"./index-CKb1g0gP.js";import{E as La}from"./el-checkbox-BY2y9xrT.js";import{a as Pa,u as rt,c as it}from"./el-radio-PusJeU-b.js";import{b as Ma}from"./buildTreeFromList-wDdEcBgZ.js";import{v as ut}from"./validate-CdMOi96S.js";import{r as Da,a as Fa,b as Ua,c as xa,u as za,d as Ha}from"./note-BGf9vSpi.js";import{a as ct}from"./permissionValidate-DlOLNRd5.js";import"./index.esm-DueM3VUK.js";var Ra=1/0;function qa(a){var o=a==null?0:a.length;return o?Rt(a,Ra):[]}var Ka=ye({name:"NodeContent",setup(){return{ns:we("cascader-node")}},render(){const{ns:a}=this,{node:o,panel:t}=this.$parent,{data:e,label:n}=o,{renderLabelFn:s}=t;return qt("span",{class:a.e("label")},s?s({node:o,data:e}):n)}});const Ze=Symbol(),Oa=ye({name:"ElCascaderNode",components:{ElCheckbox:La,ElRadio:Pa,NodeContent:Ka,ElIcon:Se,Check:mt,Loading:vt,ArrowRight:Kt},props:{node:{type:Object,required:!0},menuId:String},emits:["expand"],setup(a,{emit:o}){const t=ht(Ze),e=we("cascader-node"),n=E(()=>t.isHoverMenu),s=E(()=>t.config.multiple),r=E(()=>t.config.checkStrictly),m=E(()=>{var S;return(S=t.checkedNodes[0])==null?void 0:S.uid}),u=E(()=>a.node.isDisabled),p=E(()=>a.node.isLeaf),I=E(()=>r.value&&!p.value||!u.value),F=E(()=>se(t.expandingNode)),P=E(()=>r.value&&t.checkedNodes.some(se)),se=S=>{var L;const{level:G,uid:oe}=a.node;return((L=S==null?void 0:S.pathNodes[G-1])==null?void 0:L.uid)===oe},W=()=>{F.value||t.expandNode(a.node)},j=S=>{const{node:L}=a;S!==L.checked&&t.handleCheckChange(L,S)},q=()=>{t.lazyLoad(a.node,()=>{p.value||W()})},H=S=>{n.value&&(K(),!p.value&&o("expand",S))},K=()=>{const{node:S}=a;!I.value||S.loading||(S.loaded?W():q())},M=()=>{n.value&&!p.value||(p.value&&!u.value&&!r.value&&!s.value?D(!0):K())},Z=S=>{r.value?(j(S),a.node.loaded&&W()):D(S)},D=S=>{a.node.loaded?(j(S),!r.value&&W()):q()};return{panel:t,isHoverMenu:n,multiple:s,checkStrictly:r,checkedNodeId:m,isDisabled:u,isLeaf:p,expandable:I,inExpandingPath:F,inCheckedPath:P,ns:e,handleHoverExpand:H,handleExpand:K,handleClick:M,handleCheck:D,handleSelectCheck:Z}}});function ja(a,o,t,e,n,s){const r=J("el-checkbox"),m=J("el-radio"),u=J("check"),p=J("el-icon"),I=J("node-content"),F=J("loading"),P=J("arrow-right");return g(),x("li",{id:`${a.menuId}-${a.node.uid}`,role:"menuitem","aria-haspopup":!a.isLeaf,"aria-owns":a.isLeaf?null:a.menuId,"aria-expanded":a.inExpandingPath,tabindex:a.expandable?-1:void 0,class:U([a.ns.b(),a.ns.is("selectable",a.checkStrictly),a.ns.is("active",a.node.checked),a.ns.is("disabled",!a.expandable),a.inExpandingPath&&"in-active-path",a.inCheckedPath&&"in-checked-path"]),onMouseenter:a.handleHoverExpand,onFocus:a.handleHoverExpand,onClick:a.handleClick},[ee(" prefix "),a.multiple?(g(),z(r,{key:0,"model-value":a.node.checked,indeterminate:a.node.indeterminate,disabled:a.isDisabled,onClick:Ee(()=>{},["stop"]),"onUpdate:modelValue":a.handleSelectCheck},null,8,["model-value","indeterminate","disabled","onClick","onUpdate:modelValue"])):a.checkStrictly?(g(),z(m,{key:1,"model-value":a.checkedNodeId,label:a.node.uid,disabled:a.isDisabled,"onUpdate:modelValue":a.handleSelectCheck,onClick:Ee(()=>{},["stop"])},{default:w(()=>[ee(`
        Add an empty element to avoid render label,
        do not use empty fragment here for https://github.com/vuejs/vue-next/pull/2485
      `),te("span")]),_:1},8,["model-value","label","disabled","onUpdate:modelValue","onClick"])):a.isLeaf&&a.node.checked?(g(),z(p,{key:2,class:U(a.ns.e("prefix"))},{default:w(()=>[A(u)]),_:1},8,["class"])):ee("v-if",!0),ee(" content "),A(I),ee(" postfix "),a.isLeaf?ee("v-if",!0):(g(),x(ge,{key:3},[a.node.loading?(g(),z(p,{key:0,class:U([a.ns.is("loading"),a.ns.e("postfix")])},{default:w(()=>[A(F)]),_:1},8,["class"])):(g(),z(p,{key:1,class:U(["arrow-right",a.ns.e("postfix")])},{default:w(()=>[A(P)]),_:1},8,["class"]))],64))],42,["id","aria-haspopup","aria-owns","aria-expanded","tabindex","onMouseenter","onFocus","onClick"])}var Wa=Pe(Oa,[["render",ja],["__file","node.vue"]]);const Za=ye({name:"ElCascaderMenu",components:{Loading:vt,ElIcon:Se,ElScrollbar:yt,ElCascaderNode:Wa},props:{nodes:{type:Array,required:!0},index:{type:Number,required:!0}},setup(a){const o=jt(),t=we("cascader-menu"),{t:e}=gt(),n=Ot();let s=null,r=null;const m=ht(Ze),u=V(null),p=E(()=>!a.nodes.length),I=E(()=>!m.initialLoaded),F=E(()=>`${n.value}-${a.index}`),P=q=>{s=q.target},se=q=>{if(!(!m.isHoverMenu||!s||!u.value))if(s.contains(q.target)){W();const H=o.vnode.el,{left:K}=H.getBoundingClientRect(),{offsetWidth:M,offsetHeight:Z}=H,D=q.clientX-K,S=s.offsetTop,L=S+s.offsetHeight;u.value.innerHTML=`
          <path style="pointer-events: auto;" fill="transparent" d="M${D} ${S} L${M} 0 V${S} Z" />
          <path style="pointer-events: auto;" fill="transparent" d="M${D} ${L} L${M} ${Z} V${L} Z" />
        `}else r||(r=window.setTimeout(j,m.config.hoverThreshold))},W=()=>{r&&(clearTimeout(r),r=null)},j=()=>{u.value&&(u.value.innerHTML="",W())};return{ns:t,panel:m,hoverZone:u,isEmpty:p,isLoading:I,menuId:F,t:e,handleExpand:P,handleMouseMove:se,clearHoverZone:j}}});function Ga(a,o,t,e,n,s){const r=J("el-cascader-node"),m=J("loading"),u=J("el-icon"),p=J("el-scrollbar");return g(),z(p,{key:a.menuId,tag:"ul",role:"menu",class:U(a.ns.b()),"wrap-class":a.ns.e("wrap"),"view-class":[a.ns.e("list"),a.ns.is("empty",a.isEmpty)],onMousemove:a.handleMouseMove,onMouseleave:a.clearHoverZone},{default:w(()=>{var I;return[(g(!0),x(ge,null,_e(a.nodes,F=>(g(),z(r,{key:F.uid,node:F,"menu-id":a.menuId,onExpand:a.handleExpand},null,8,["node","menu-id","onExpand"]))),128)),a.isLoading?(g(),x("div",{key:0,class:U(a.ns.e("empty-text"))},[A(u,{size:"14",class:U(a.ns.is("loading"))},{default:w(()=>[A(m)]),_:1},8,["class"]),he(" "+ae(a.t("el.cascader.loading")),1)],2)):a.isEmpty?(g(),x("div",{key:1,class:U(a.ns.e("empty-text"))},[Te(a.$slots,"empty",{},()=>[he(ae(a.t("el.cascader.noData")),1)])],2)):(I=a.panel)!=null&&I.isHoverMenu?(g(),x("svg",{key:2,ref:"hoverZone",class:U(a.ns.e("hover-zone"))},null,2)):ee("v-if",!0)]}),_:3},8,["class","wrap-class","view-class","onMousemove","onMouseleave"])}var Xa=Pe(Za,[["render",Ga],["__file","menu.vue"]]);let Ya=0;const Ja=a=>{const o=[a];let{parent:t}=a;for(;t;)o.unshift(t),t=t.parent;return o};class ke{constructor(o,t,e,n=!1){this.data=o,this.config=t,this.parent=e,this.root=n,this.uid=Ya++,this.checked=!1,this.indeterminate=!1,this.loading=!1;const{value:s,label:r,children:m}=t,u=o[m],p=Ja(this);this.level=n?0:e?e.level+1:1,this.value=o[s],this.label=o[r],this.pathNodes=p,this.pathValues=p.map(I=>I.value),this.pathLabels=p.map(I=>I.label),this.childrenData=u,this.children=(u||[]).map(I=>new ke(I,t,this)),this.loaded=!t.lazy||this.isLeaf||!Ke(u)}get isDisabled(){const{data:o,parent:t,config:e}=this,{disabled:n,checkStrictly:s}=e;return(et(n)?n(o,this):!!o[n])||!s&&(t==null?void 0:t.isDisabled)}get isLeaf(){const{data:o,config:t,childrenData:e,loaded:n}=this,{lazy:s,leaf:r}=t,m=et(r)?r(o,this):o[r];return Wt(m)?s&&!n?!1:!(tt(e)&&e.length):!!m}get valueByOption(){return this.config.emitPath?this.pathValues:this.value}appendChild(o){const{childrenData:t,children:e}=this,n=new ke(o,this.config,this);return tt(t)?t.push(o):this.childrenData=[o],e.push(n),n}calcText(o,t){const e=o?this.pathLabels.join(t):this.label;return this.text=e,e}broadcast(o,...t){const e=`onParent${at(o)}`;this.children.forEach(n=>{n&&(n.broadcast(o,...t),n[e]&&n[e](...t))})}emit(o,...t){const{parent:e}=this,n=`onChild${at(o)}`;e&&(e[n]&&e[n](...t),e.emit(o,...t))}onParentCheck(o){this.isDisabled||this.setCheckState(o)}onChildCheck(){const{children:o}=this,t=o.filter(n=>!n.isDisabled),e=t.length?t.every(n=>n.checked):!1;this.setCheckState(e)}setCheckState(o){const t=this.children.length,e=this.children.reduce((n,s)=>{const r=s.checked?1:s.indeterminate?.5:0;return n+r},0);this.checked=this.loaded&&this.children.filter(n=>!n.isDisabled).every(n=>n.loaded&&n.checked)&&o,this.indeterminate=this.loaded&&e!==t&&e>0}doCheck(o){if(this.checked===o)return;const{checkStrictly:t,multiple:e}=this.config;t||!e?this.checked=o:(this.broadcast("check",o),this.setCheckState(o),this.emit("check"))}}const je=(a,o)=>a.reduce((t,e)=>(e.isLeaf?t.push(e):(!o&&t.push(e),t=t.concat(je(e.children,o))),t),[]);class dt{constructor(o,t){this.config=t;const e=(o||[]).map(n=>new ke(n,this.config));this.nodes=e,this.allNodes=je(e,!1),this.leafNodes=je(e,!0)}getNodes(){return this.nodes}getFlattedNodes(o){return o?this.leafNodes:this.allNodes}appendNode(o,t){const e=t?t.appendChild(o):new ke(o,this.config);t||this.nodes.push(e),this.allNodes.push(e),e.isLeaf&&this.leafNodes.push(e)}appendNodes(o,t){o.forEach(e=>this.appendNode(e,t))}getNodeByValue(o,t=!1){return!o&&o!==0?null:this.getFlattedNodes(t).find(n=>Ve(n.value,o)||Ve(n.pathValues,o))||null}getSameNode(o){return o&&this.getFlattedNodes(!1).find(({value:e,level:n})=>Ve(o.value,e)&&o.level===n)||null}}const St=bt({modelValue:{type:me([Number,String,Array])},options:{type:me(Array),default:()=>[]},props:{type:me(Object),default:()=>({})}}),Qa={expandTrigger:"click",multiple:!1,checkStrictly:!1,emitPath:!0,lazy:!1,lazyLoad:Zt,value:"value",label:"label",children:"children",leaf:"leaf",disabled:"disabled",hoverThreshold:500},en=a=>E(()=>({...Qa,...a.props})),pt=a=>{if(!a)return 0;const o=a.id.split("-");return Number(o[o.length-2])},tn=a=>{if(!a)return;const o=a.querySelector("input");o?o.click():Gt(a)&&a.click()},an=(a,o)=>{const t=o.slice(0),e=t.map(s=>s.uid),n=a.reduce((s,r)=>{const m=e.indexOf(r.uid);return m>-1&&(s.push(r),t.splice(m,1),e.splice(m,1)),s},[]);return n.push(...t),n},nn=ye({name:"ElCascaderPanel",components:{ElCascaderMenu:Xa},props:{...St,border:{type:Boolean,default:!0},renderLabel:Function},emits:[Be,Le,"close","expand-change"],setup(a,{emit:o,slots:t}){let e=!1;const n=we("cascader"),s=en(a);let r=null;const m=V(!0),u=V([]),p=V(null),I=V([]),F=V(null),P=V([]),se=E(()=>s.value.expandTrigger==="hover"),W=E(()=>a.renderLabel||t.default),j=()=>{const{options:f}=a,y=s.value;e=!1,r=new dt(f,y),I.value=[r.getNodes()],y.lazy&&Ke(a.options)?(m.value=!1,q(void 0,k=>{k&&(r=new dt(k,y),I.value=[r.getNodes()]),m.value=!0,G(!1,!0)})):G(!1,!0)},q=(f,y)=>{const k=s.value;f=f||new ke({},k,void 0,!0),f.loading=!0;const b=v=>{const i=f,N=i.root?null:i;v&&(r==null||r.appendNodes(v,N)),i.loading=!1,i.loaded=!0,i.childrenData=i.childrenData||[],y&&y(v)};k.lazyLoad(f,b)},H=(f,y)=>{var k;const{level:b}=f,v=I.value.slice(0,b);let i;f.isLeaf?i=f.pathNodes[b-2]:(i=f,v.push(f.children)),((k=F.value)==null?void 0:k.uid)!==(i==null?void 0:i.uid)&&(F.value=f,I.value=v,!y&&o("expand-change",(f==null?void 0:f.pathValues)||[]))},K=(f,y,k=!0)=>{const{checkStrictly:b,multiple:v}=s.value,i=P.value[0];e=!0,!v&&(i==null||i.doCheck(!1)),f.doCheck(y),L(),k&&!v&&!b&&o("close"),!k&&!v&&!b&&M(f)},M=f=>{f&&(f=f.parent,M(f),f&&H(f))},Z=f=>r==null?void 0:r.getFlattedNodes(f),D=f=>{var y;return(y=Z(f))==null?void 0:y.filter(k=>k.checked!==!1)},S=()=>{P.value.forEach(f=>f.doCheck(!1)),L(),I.value=I.value.slice(0,1),F.value=null,o("expand-change",[])},L=()=>{var f;const{checkStrictly:y,multiple:k}=s.value,b=P.value,v=D(!y),i=an(b,v),N=i.map(C=>C.valueByOption);P.value=i,p.value=k?N:(f=N[0])!=null?f:null},G=(f=!1,y=!1)=>{const{modelValue:k}=a,{lazy:b,multiple:v,checkStrictly:i}=s.value,N=!i;if(!(!m.value||e||!y&&Ve(k,p.value)))if(b&&!f){const _=rt(qa(it(k))).map(R=>r==null?void 0:r.getNodeByValue(R)).filter(R=>!!R&&!R.loaded&&!R.loading);_.length?_.forEach(R=>{q(R,()=>G(!1,y))}):G(!0,y)}else{const C=v?it(k):[k],_=rt(C.map(R=>r==null?void 0:r.getNodeByValue(R,N)));oe(_,y),p.value=_t(k)}},oe=(f,y=!0)=>{const{checkStrictly:k}=s.value,b=P.value,v=f.filter(C=>!!C&&(k||C.isLeaf)),i=r==null?void 0:r.getSameNode(F.value),N=y&&i||v[0];N?N.pathNodes.forEach(C=>H(C,!0)):F.value=null,b.forEach(C=>C.doCheck(!1)),nt(v).forEach(C=>C.doCheck(!0)),P.value=v,ve(Q)},Q=()=>{Ct&&u.value.forEach(f=>{const y=f==null?void 0:f.$el;if(y){const k=y.querySelector(`.${n.namespace.value}-scrollbar__wrap`),b=y.querySelector(`.${n.b("node")}.${n.is("active")}`)||y.querySelector(`.${n.b("node")}.in-active-path`);Yt(k,b)}})},ne=f=>{const y=f.target,{code:k}=f;switch(k){case O.up:case O.down:{f.preventDefault();const b=k===O.up?-1:1;Ae(wt(y,b,`.${n.b("node")}[tabindex="-1"]`));break}case O.left:{f.preventDefault();const b=u.value[pt(y)-1],v=b==null?void 0:b.$el.querySelector(`.${n.b("node")}[aria-expanded="true"]`);Ae(v);break}case O.right:{f.preventDefault();const b=u.value[pt(y)+1],v=b==null?void 0:b.$el.querySelector(`.${n.b("node")}[tabindex="-1"]`);Ae(v);break}case O.enter:case O.numpadEnter:tn(y);break}};return Xt(Ze,nt({config:s,expandingNode:F,checkedNodes:P,isHoverMenu:se,initialLoaded:m,renderLabelFn:W,lazyLoad:q,expandNode:H,handleCheckChange:K})),pe([s,()=>a.options],j,{deep:!0,immediate:!0}),pe(()=>a.modelValue,()=>{e=!1,G()},{deep:!0}),pe(()=>p.value,f=>{Ve(f,a.modelValue)||(o(Be,f),o(Le,f))}),Jt(()=>u.value=[]),We(()=>!Ke(a.modelValue)&&G()),{ns:n,menuList:u,menus:I,checkedNodes:P,handleKeyDown:ne,handleCheckChange:K,getFlattedNodes:Z,getCheckedNodes:D,clearCheckedNodes:S,calculateCheckedValue:L,scrollToExpandingNode:Q}}});function sn(a,o,t,e,n,s){const r=J("el-cascader-menu");return g(),x("div",{class:U([a.ns.b("panel"),a.ns.is("bordered",a.border)]),onKeydown:a.handleKeyDown},[(g(!0),x(ge,null,_e(a.menus,(m,u)=>(g(),z(r,{key:u,ref_for:!0,ref:p=>a.menuList[u]=p,index:u,nodes:[...m]},{empty:w(()=>[Te(a.$slots,"empty")]),_:2},1032,["index","nodes"]))),128))],42,["onKeydown"])}var on=Pe(nn,[["render",sn],["__file","index.vue"]]);const ln=kt(on),rn=bt({...St,size:na,placeholder:String,disabled:Boolean,clearable:Boolean,filterable:Boolean,filterMethod:{type:me(Function),default:(a,o)=>a.text.includes(o)},separator:{type:String,default:" / "},showAllLevels:{type:Boolean,default:!0},collapseTags:Boolean,maxCollapseTags:{type:Number,default:1},collapseTagsTooltip:{type:Boolean,default:!1},debounce:{type:Number,default:300},beforeFilter:{type:me(Function),default:()=>!0},placement:{type:me(String),values:aa,default:"bottom-start"},fallbackPlacements:{type:me(Array),default:["bottom-start","bottom","top-start","top","right","left"]},popperClass:{type:String,default:""},teleported:ta.teleported,tagType:{...st.type,default:"info"},tagEffect:{...st.effect,default:"light"},validateEvent:{type:Boolean,default:!0},persistent:{type:Boolean,default:!0},...ea}),un={[Be]:a=>!0,[Le]:a=>!0,focus:a=>a instanceof FocusEvent,blur:a=>a instanceof FocusEvent,clear:()=>!0,visibleChange:a=>Qt(a),expandChange:a=>!!a,removeTag:a=>!!a},cn="ElCascader",dn=ye({name:cn}),pn=ye({...dn,props:rn,emits:un,setup(a,{expose:o,emit:t}){const e=a,n={modifiers:[{name:"arrowPosition",enabled:!0,phase:"main",fn:({state:l})=>{const{modifiersData:c,placement:d}=l;["right","left","bottom","top"].includes(d)||(c.arrow.x=35)},requires:["arrow"]}]},s=sa();let r=0,m=0;const u=we("cascader"),p=we("input"),{t:I}=gt(),{form:F,formItem:P}=oa(),{valueOnClear:se}=la(e),{isComposing:W,handleComposition:j}=ra({afterComposition(l){var c;const d=(c=l.target)==null?void 0:c.value;qe(d)}}),q=V(null),H=V(null),K=V(null),M=V(null),Z=V(null),D=V(!1),S=V(!1),L=V(!1),G=V(!1),oe=V(""),Q=V(""),ne=V([]),f=V([]),y=V([]),k=E(()=>s.style),b=E(()=>e.disabled||(F==null?void 0:F.disabled)),v=E(()=>e.placeholder||I("el.cascader.placeholder")),i=E(()=>Q.value||ne.value.length>0||W.value?"":v.value),N=ca(),C=E(()=>["small"].includes(N.value)?"small":"default"),_=E(()=>!!e.props.multiple),R=E(()=>!e.filterable||_.value),ce=E(()=>_.value?Q.value:oe.value),de=E(()=>{var l;return((l=M.value)==null?void 0:l.checkedNodes)||[]}),be=E(()=>!e.clearable||b.value||L.value||!S.value?!1:!!de.value.length),Ce=E(()=>{const{showAllLevels:l,separator:c}=e,d=de.value;return d.length?_.value?"":d[0].calcText(l,c):""}),De=E(()=>(P==null?void 0:P.validateState)||""),$=E({get(){return _t(e.modelValue)},set(l){const c=l??se.value;t(Be,c),t(Le,c),e.validateEvent&&(P==null||P.validate("change").catch(d=>da()))}}),fe=E(()=>[u.b(),u.m(N.value),u.is("disabled",b.value),s.class]),Fe=E(()=>[p.e("icon"),"icon-arrow-down",u.is("reverse",D.value)]),Tt=E(()=>u.is("focus",D.value||G.value)),Ge=E(()=>{var l,c;return(c=(l=q.value)==null?void 0:l.popperRef)==null?void 0:c.contentRef}),Y=l=>{var c,d,T;b.value||(l=l??!D.value,l!==D.value&&(D.value=l,(d=(c=H.value)==null?void 0:c.input)==null||d.setAttribute("aria-expanded",`${l}`),l?(Ne(),ve((T=M.value)==null?void 0:T.scrollToExpandingNode)):e.filterable&&Re(),t("visibleChange",l)))},Ne=()=>{ve(()=>{var l;(l=q.value)==null||l.updatePopper()})},Ue=()=>{L.value=!1},xe=l=>{const{showAllLevels:c,separator:d}=e;return{node:l,key:l.uid,text:l.calcText(c,d),hitState:!1,closable:!b.value&&!l.isDisabled,isCollapseTag:!1}},ze=l=>{var c;const d=l.node;d.doCheck(!1),(c=M.value)==null||c.calculateCheckedValue(),t("removeTag",d.valueByOption)},Bt=()=>{if(!_.value)return;const l=de.value,c=[],d=[];if(l.forEach(T=>d.push(xe(T))),f.value=d,l.length){l.slice(0,e.maxCollapseTags).forEach(le=>c.push(xe(le)));const T=l.slice(e.maxCollapseTags),ie=T.length;ie&&(e.collapseTags?c.push({key:-1,text:`+ ${ie}`,closable:!1,isCollapseTag:!0}):T.forEach(le=>c.push(xe(le))))}ne.value=c},Xe=()=>{var l,c;const{filterMethod:d,showAllLevels:T,separator:ie}=e,le=(c=(l=M.value)==null?void 0:l.getFlattedNodes(!e.props.checkStrictly))==null?void 0:c.filter(ue=>ue.isDisabled?!1:(ue.calcText(T,ie),d(ue,ce.value)));_.value&&(ne.value.forEach(ue=>{ue.hitState=!1}),f.value.forEach(ue=>{ue.hitState=!1})),L.value=!0,y.value=le,Ne()},Lt=()=>{var l;let c;L.value&&Z.value?c=Z.value.$el.querySelector(`.${u.e("suggestion-item")}`):c=(l=M.value)==null?void 0:l.$el.querySelector(`.${u.b("node")}[tabindex="-1"]`),c&&(c.focus(),!L.value&&c.click())},He=()=>{var l,c;const d=(l=H.value)==null?void 0:l.input,T=K.value,ie=(c=Z.value)==null?void 0:c.$el;if(!(!Ct||!d)){if(ie){const le=ie.querySelector(`.${u.e("suggestion-list")}`);le.style.minWidth=`${d.offsetWidth}px`}if(T){const{offsetHeight:le}=T,ue=ne.value.length>0?`${Math.max(le+6,r)}px`:`${r}px`;d.style.height=ue,Ne()}}},Pt=l=>{var c;return(c=M.value)==null?void 0:c.getCheckedNodes(l)},Mt=l=>{Ne(),t("expandChange",l)},Dt=l=>{if(!W.value)switch(l.code){case O.enter:case O.numpadEnter:Y();break;case O.down:Y(!0),ve(Lt),l.preventDefault();break;case O.esc:D.value===!0&&(l.preventDefault(),l.stopPropagation(),Y(!1));break;case O.tab:Y(!1);break}},Ft=()=>{var l;(l=M.value)==null||l.clearCheckedNodes(),!D.value&&e.filterable&&Re(),Y(!1),t("clear")},Re=()=>{const{value:l}=Ce;oe.value=l,Q.value=l},Ut=l=>{var c,d;const{checked:T}=l;_.value?(c=M.value)==null||c.handleCheckChange(l,!T,!1):(!T&&((d=M.value)==null||d.handleCheckChange(l,!0,!1)),Y(!1))},xt=l=>{const c=l.target,{code:d}=l;switch(d){case O.up:case O.down:{const T=d===O.up?-1:1;Ae(wt(c,T,`.${u.e("suggestion-item")}[tabindex="-1"]`));break}case O.enter:case O.numpadEnter:c.click();break}},zt=()=>{const l=ne.value,c=l[l.length-1];m=Q.value?0:m+1,!(!c||!m||e.collapseTags&&l.length>1)&&(c.hitState?ze(c):c.hitState=!0)},Ye=l=>{const c=l.target,d=u.e("search-input");c.className===d&&(G.value=!0),t("focus",l)},Je=l=>{G.value=!1,t("blur",l)},Ht=ia(()=>{const{value:l}=ce;if(!l)return;const c=e.beforeFilter(l);ua(c)?c.then(Xe).catch(()=>{}):c!==!1?Xe():Ue()},e.debounce),qe=(l,c)=>{!D.value&&Y(!0),!(c!=null&&c.isComposing)&&(l?Ht():Ue())},Qe=l=>Number.parseFloat(pa(p.cssVarName("input-height"),l).value)-2;return pe(L,Ne),pe([de,b,()=>e.collapseTags],Bt),pe(ne,()=>{ve(()=>He())}),pe(N,async()=>{await ve();const l=H.value.input;r=Qe(l)||r,He()}),pe(Ce,Re,{immediate:!0}),We(()=>{const l=H.value.input,c=Qe(l);r=l.offsetHeight||c,fa(l,He)}),o({getCheckedNodes:Pt,cascaderPanelRef:M,togglePopperVisible:Y,contentRef:Ge,presentText:Ce}),(l,c)=>(g(),z(h(lt),{ref_key:"tooltipRef",ref:q,visible:D.value,teleported:l.teleported,"popper-class":[h(u).e("dropdown"),l.popperClass],"popper-options":n,"fallback-placements":l.fallbackPlacements,"stop-popper-mouse-event":!1,"gpu-acceleration":!1,placement:l.placement,transition:`${h(u).namespace.value}-zoom-in-top`,effect:"light",pure:"",persistent:l.persistent,onHide:Ue},{default:w(()=>[$e((g(),x("div",{class:U(h(fe)),style:ba(h(k)),onClick:()=>Y(h(R)?void 0:!0),onKeydown:Dt,onMouseenter:d=>S.value=!0,onMouseleave:d=>S.value=!1},[A(h(Nt),{ref_key:"input",ref:H,modelValue:oe.value,"onUpdate:modelValue":d=>oe.value=d,placeholder:h(i),readonly:h(R),disabled:h(b),"validate-event":!1,size:h(N),class:U(h(Tt)),tabindex:h(_)&&l.filterable&&!h(b)?-1:void 0,onCompositionstart:h(j),onCompositionupdate:h(j),onCompositionend:h(j),onFocus:Ye,onBlur:Je,onInput:qe},{suffix:w(()=>[h(be)?(g(),z(h(Se),{key:"clear",class:U([h(p).e("icon"),"icon-circle-close"]),onClick:Ee(Ft,["stop"])},{default:w(()=>[A(h(ma))]),_:1},8,["class","onClick"])):(g(),z(h(Se),{key:"arrow-down",class:U(h(Fe)),onClick:Ee(d=>Y(),["stop"])},{default:w(()=>[A(h(ga))]),_:1},8,["class","onClick"]))]),_:1},8,["modelValue","onUpdate:modelValue","placeholder","readonly","disabled","size","class","tabindex","onCompositionstart","onCompositionupdate","onCompositionend"]),h(_)?(g(),x("div",{key:0,ref_key:"tagWrapper",ref:K,class:U([h(u).e("tags"),h(u).is("validate",!!h(De))])},[(g(!0),x(ge,null,_e(ne.value,d=>(g(),z(h(Oe),{key:d.key,type:l.tagType,size:h(C),effect:l.tagEffect,hit:d.hitState,closable:d.closable,"disable-transitions":"",onClose:T=>ze(d)},{default:w(()=>[d.isCollapseTag===!1?(g(),x("span",{key:0},ae(d.text),1)):(g(),z(h(lt),{key:1,disabled:D.value||!l.collapseTagsTooltip,"fallback-placements":["bottom","top","right","left"],placement:"bottom",effect:"light"},{default:w(()=>[te("span",null,ae(d.text),1)]),content:w(()=>[te("div",{class:U(h(u).e("collapse-tags"))},[(g(!0),x(ge,null,_e(f.value.slice(l.maxCollapseTags),(T,ie)=>(g(),x("div",{key:ie,class:U(h(u).e("collapse-tag"))},[(g(),z(h(Oe),{key:T.key,class:"in-tooltip",type:l.tagType,size:h(C),effect:l.tagEffect,hit:T.hitState,closable:T.closable,"disable-transitions":"",onClose:le=>ze(T)},{default:w(()=>[te("span",null,ae(T.text),1)]),_:2},1032,["type","size","effect","hit","closable","onClose"]))],2))),128))],2)]),_:2},1032,["disabled"]))]),_:2},1032,["type","size","effect","hit","closable","onClose"]))),128)),l.filterable&&!h(b)?$e((g(),x("input",{key:0,"onUpdate:modelValue":d=>Q.value=d,type:"text",class:U(h(u).e("search-input")),placeholder:h(Ce)?"":h(v),onInput:d=>qe(Q.value,d),onClick:Ee(d=>Y(!0),["stop"]),onKeydown:Et(zt,["delete"]),onCompositionstart:h(j),onCompositionupdate:h(j),onCompositionend:h(j),onFocus:Ye,onBlur:Je},null,42,["onUpdate:modelValue","placeholder","onInput","onClick","onKeydown","onCompositionstart","onCompositionupdate","onCompositionend"])),[[ya,Q.value]]):ee("v-if",!0)],2)):ee("v-if",!0)],46,["onClick","onMouseenter","onMouseleave"])),[[h(va),()=>Y(!1),h(Ge)]])]),content:w(()=>[$e(A(h(ln),{ref_key:"cascaderPanelRef",ref:M,modelValue:h($),"onUpdate:modelValue":d=>ha($)?$.value=d:null,options:l.options,props:e.props,border:!1,"render-label":l.$slots.default,onExpandChange:Mt,onClose:d=>l.$nextTick(()=>Y(!1))},{empty:w(()=>[Te(l.$slots,"empty")]),_:3},8,["modelValue","onUpdate:modelValue","options","props","render-label","onClose"]),[[ot,!L.value]]),l.filterable?$e((g(),z(h(yt),{key:0,ref_key:"suggestionPanel",ref:Z,tag:"ul",class:U(h(u).e("suggestion-panel")),"view-class":h(u).e("suggestion-list"),onKeydown:xt},{default:w(()=>[y.value.length?(g(!0),x(ge,{key:0},_e(y.value,d=>(g(),x("li",{key:d.uid,class:U([h(u).e("suggestion-item"),h(u).is("checked",d.checked)]),tabindex:-1,onClick:T=>Ut(d)},[te("span",null,ae(d.text),1),d.checked?(g(),z(h(Se),{key:0},{default:w(()=>[A(h(mt))]),_:1})):ee("v-if",!0)],10,["onClick"]))),128)):Te(l.$slots,"empty",{key:1},()=>[te("li",{class:U(h(u).e("empty-text"))},ae(h(I)("el.cascader.noMatch")),3)])]),_:3},8,["class","view-class"])),[[ot,L.value]]):ee("v-if",!0)]),_:3},8,["visible","teleported","popper-class","fallback-placements","placement","transition","persistent"]))}});var fn=Pe(pn,[["__file","cascader.vue"]]);const hn=kt(fn);function vn(a,o){if(!(a instanceof File))throw new Error("参数 file 必须是一个 File 对象");const t=a.name.split(".").pop();if(t)if(!o.includes("."))o+=`.${t}`;else{const e=o.split(".").pop();e!==t&&(o=o.replace(`.${e}`,`.${t}`))}return new File([a],o,{type:a.type,lastModified:a.lastModified})}function mn(a){const o=a.split(".");return o.pop(),o.join(".")}let ft=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];function re(a,o){var t=a[0],e=a[1],n=a[2],s=a[3];t+=(e&n|~e&s)+o[0]-680876936|0,t=(t<<7|t>>>25)+e|0,s+=(t&e|~t&n)+o[1]-389564586|0,s=(s<<12|s>>>20)+t|0,n+=(s&t|~s&e)+o[2]+606105819|0,n=(n<<17|n>>>15)+s|0,e+=(n&s|~n&t)+o[3]-1044525330|0,e=(e<<22|e>>>10)+n|0,t+=(e&n|~e&s)+o[4]-176418897|0,t=(t<<7|t>>>25)+e|0,s+=(t&e|~t&n)+o[5]+1200080426|0,s=(s<<12|s>>>20)+t|0,n+=(s&t|~s&e)+o[6]-1473231341|0,n=(n<<17|n>>>15)+s|0,e+=(n&s|~n&t)+o[7]-45705983|0,e=(e<<22|e>>>10)+n|0,t+=(e&n|~e&s)+o[8]+1770035416|0,t=(t<<7|t>>>25)+e|0,s+=(t&e|~t&n)+o[9]-1958414417|0,s=(s<<12|s>>>20)+t|0,n+=(s&t|~s&e)+o[10]-42063|0,n=(n<<17|n>>>15)+s|0,e+=(n&s|~n&t)+o[11]-1990404162|0,e=(e<<22|e>>>10)+n|0,t+=(e&n|~e&s)+o[12]+1804603682|0,t=(t<<7|t>>>25)+e|0,s+=(t&e|~t&n)+o[13]-40341101|0,s=(s<<12|s>>>20)+t|0,n+=(s&t|~s&e)+o[14]-1502002290|0,n=(n<<17|n>>>15)+s|0,e+=(n&s|~n&t)+o[15]+1236535329|0,e=(e<<22|e>>>10)+n|0,t+=(e&s|n&~s)+o[1]-165796510|0,t=(t<<5|t>>>27)+e|0,s+=(t&n|e&~n)+o[6]-1069501632|0,s=(s<<9|s>>>23)+t|0,n+=(s&e|t&~e)+o[11]+643717713|0,n=(n<<14|n>>>18)+s|0,e+=(n&t|s&~t)+o[0]-373897302|0,e=(e<<20|e>>>12)+n|0,t+=(e&s|n&~s)+o[5]-701558691|0,t=(t<<5|t>>>27)+e|0,s+=(t&n|e&~n)+o[10]+38016083|0,s=(s<<9|s>>>23)+t|0,n+=(s&e|t&~e)+o[15]-660478335|0,n=(n<<14|n>>>18)+s|0,e+=(n&t|s&~t)+o[4]-405537848|0,e=(e<<20|e>>>12)+n|0,t+=(e&s|n&~s)+o[9]+568446438|0,t=(t<<5|t>>>27)+e|0,s+=(t&n|e&~n)+o[14]-1019803690|0,s=(s<<9|s>>>23)+t|0,n+=(s&e|t&~e)+o[3]-187363961|0,n=(n<<14|n>>>18)+s|0,e+=(n&t|s&~t)+o[8]+1163531501|0,e=(e<<20|e>>>12)+n|0,t+=(e&s|n&~s)+o[13]-1444681467|0,t=(t<<5|t>>>27)+e|0,s+=(t&n|e&~n)+o[2]-51403784|0,s=(s<<9|s>>>23)+t|0,n+=(s&e|t&~e)+o[7]+1735328473|0,n=(n<<14|n>>>18)+s|0,e+=(n&t|s&~t)+o[12]-1926607734|0,e=(e<<20|e>>>12)+n|0,t+=(e^n^s)+o[5]-378558|0,t=(t<<4|t>>>28)+e|0,s+=(t^e^n)+o[8]-2022574463|0,s=(s<<11|s>>>21)+t|0,n+=(s^t^e)+o[11]+1839030562|0,n=(n<<16|n>>>16)+s|0,e+=(n^s^t)+o[14]-35309556|0,e=(e<<23|e>>>9)+n|0,t+=(e^n^s)+o[1]-1530992060|0,t=(t<<4|t>>>28)+e|0,s+=(t^e^n)+o[4]+1272893353|0,s=(s<<11|s>>>21)+t|0,n+=(s^t^e)+o[7]-155497632|0,n=(n<<16|n>>>16)+s|0,e+=(n^s^t)+o[10]-1094730640|0,e=(e<<23|e>>>9)+n|0,t+=(e^n^s)+o[13]+681279174|0,t=(t<<4|t>>>28)+e|0,s+=(t^e^n)+o[0]-358537222|0,s=(s<<11|s>>>21)+t|0,n+=(s^t^e)+o[3]-722521979|0,n=(n<<16|n>>>16)+s|0,e+=(n^s^t)+o[6]+76029189|0,e=(e<<23|e>>>9)+n|0,t+=(e^n^s)+o[9]-640364487|0,t=(t<<4|t>>>28)+e|0,s+=(t^e^n)+o[12]-421815835|0,s=(s<<11|s>>>21)+t|0,n+=(s^t^e)+o[15]+530742520|0,n=(n<<16|n>>>16)+s|0,e+=(n^s^t)+o[2]-995338651|0,e=(e<<23|e>>>9)+n|0,t+=(n^(e|~s))+o[0]-198630844|0,t=(t<<6|t>>>26)+e|0,s+=(e^(t|~n))+o[7]+1126891415|0,s=(s<<10|s>>>22)+t|0,n+=(t^(s|~e))+o[14]-1416354905|0,n=(n<<15|n>>>17)+s|0,e+=(s^(n|~t))+o[5]-57434055|0,e=(e<<21|e>>>11)+n|0,t+=(n^(e|~s))+o[12]+1700485571|0,t=(t<<6|t>>>26)+e|0,s+=(e^(t|~n))+o[3]-1894986606|0,s=(s<<10|s>>>22)+t|0,n+=(t^(s|~e))+o[10]-1051523|0,n=(n<<15|n>>>17)+s|0,e+=(s^(n|~t))+o[1]-2054922799|0,e=(e<<21|e>>>11)+n|0,t+=(n^(e|~s))+o[8]+1873313359|0,t=(t<<6|t>>>26)+e|0,s+=(e^(t|~n))+o[15]-30611744|0,s=(s<<10|s>>>22)+t|0,n+=(t^(s|~e))+o[6]-1560198380|0,n=(n<<15|n>>>17)+s|0,e+=(s^(n|~t))+o[13]+1309151649|0,e=(e<<21|e>>>11)+n|0,t+=(n^(e|~s))+o[4]-145523070|0,t=(t<<6|t>>>26)+e|0,s+=(e^(t|~n))+o[11]-1120210379|0,s=(s<<10|s>>>22)+t|0,n+=(t^(s|~e))+o[2]+718787259|0,n=(n<<15|n>>>17)+s|0,e+=(s^(n|~t))+o[9]-343485551|0,e=(e<<21|e>>>11)+n|0,a[0]=t+a[0]|0,a[1]=e+a[1]|0,a[2]=n+a[2]|0,a[3]=s+a[3]|0}function Vt(a){var o=[],t;for(t=0;t<64;t+=4)o[t>>2]=a.charCodeAt(t)+(a.charCodeAt(t+1)<<8)+(a.charCodeAt(t+2)<<16)+(a.charCodeAt(t+3)<<24);return o}function It(a){var o=[],t;for(t=0;t<64;t+=4)o[t>>2]=a[t]+(a[t+1]<<8)+(a[t+2]<<16)+(a[t+3]<<24);return o}function $t(a){var o=a.length,t=[1732584193,-271733879,-1732584194,271733878],e,n,s,r,m,u;for(e=64;e<=o;e+=64)re(t,Vt(a.substring(e-64,e)));for(a=a.substring(e-64),n=a.length,s=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],e=0;e<n;e+=1)s[e>>2]|=a.charCodeAt(e)<<(e%4<<3);if(s[e>>2]|=128<<(e%4<<3),e>55)for(re(t,s),e=0;e<16;e+=1)s[e]=0;return r=o*8,r=r.toString(16).match(/(.*?)(.{0,8})$/),m=parseInt(r[2],16),u=parseInt(r[1],16)||0,s[14]=m,s[15]=u,re(t,s),t}function gn(a){var o=a.length,t=[1732584193,-271733879,-1732584194,271733878],e,n,s,r,m,u;for(e=64;e<=o;e+=64)re(t,It(a.subarray(e-64,e)));for(a=e-64<o?a.subarray(e-64):new Uint8Array(0),n=a.length,s=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],e=0;e<n;e+=1)s[e>>2]|=a[e]<<(e%4<<3);if(s[e>>2]|=128<<(e%4<<3),e>55)for(re(t,s),e=0;e<16;e+=1)s[e]=0;return r=o*8,r=r.toString(16).match(/(.*?)(.{0,8})$/),m=parseInt(r[2],16),u=parseInt(r[1],16)||0,s[14]=m,s[15]=u,re(t,s),t}function yn(a){var o="",t;for(t=0;t<4;t+=1)o+=ft[a>>t*8+4&15]+ft[a>>t*8&15];return o}function Ie(a){var o;for(o=0;o<a.length;o+=1)a[o]=yn(a[o]);return a.join("")}Ie($t("hello"));typeof ArrayBuffer<"u"&&!ArrayBuffer.prototype.slice&&function(){function a(o,t){return o=o|0||0,o<0?Math.max(o+t,0):Math.min(o,t)}ArrayBuffer.prototype.slice=function(o,t){var e=this.byteLength,n=a(o,e),s=e,r,m,u,p;return t!==void 0&&(s=a(t,e)),n>s?new ArrayBuffer(0):(r=s-n,m=new ArrayBuffer(r),u=new Uint8Array(m),p=new Uint8Array(this,n,r),u.set(p),m)}}();function At(a){return/[\u0080-\uFFFF]/.test(a)&&(a=unescape(encodeURIComponent(a))),a}function bn(a,o){var t=a.length,e=new ArrayBuffer(t),n=new Uint8Array(e),s;for(s=0;s<t;s+=1)n[s]=a.charCodeAt(s);return o?n:e}function Cn(a){return String.fromCharCode.apply(null,new Uint8Array(a))}function _n(a,o,t){var e=new Uint8Array(a.byteLength+o.byteLength);return e.set(new Uint8Array(a)),e.set(new Uint8Array(o),a.byteLength),e}function Me(a){var o=[],t=a.length,e;for(e=0;e<t-1;e+=2)o.push(parseInt(a.substr(e,2),16));return String.fromCharCode.apply(String,o)}function B(){this.reset()}B.prototype.append=function(a){return this.appendBinary(At(a)),this};B.prototype.appendBinary=function(a){this._buff+=a,this._length+=a.length;var o=this._buff.length,t;for(t=64;t<=o;t+=64)re(this._hash,Vt(this._buff.substring(t-64,t)));return this._buff=this._buff.substring(t-64),this};B.prototype.end=function(a){var o=this._buff,t=o.length,e,n=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],s;for(e=0;e<t;e+=1)n[e>>2]|=o.charCodeAt(e)<<(e%4<<3);return this._finish(n,t),s=Ie(this._hash),a&&(s=Me(s)),this.reset(),s};B.prototype.reset=function(){return this._buff="",this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this};B.prototype.getState=function(){return{buff:this._buff,length:this._length,hash:this._hash.slice()}};B.prototype.setState=function(a){return this._buff=a.buff,this._length=a.length,this._hash=a.hash,this};B.prototype.destroy=function(){delete this._hash,delete this._buff,delete this._length};B.prototype._finish=function(a,o){var t=o,e,n,s;if(a[t>>2]|=128<<(t%4<<3),t>55)for(re(this._hash,a),t=0;t<16;t+=1)a[t]=0;e=this._length*8,e=e.toString(16).match(/(.*?)(.{0,8})$/),n=parseInt(e[2],16),s=parseInt(e[1],16)||0,a[14]=n,a[15]=s,re(this._hash,a)};B.hash=function(a,o){return B.hashBinary(At(a),o)};B.hashBinary=function(a,o){var t=$t(a),e=Ie(t);return o?Me(e):e};B.ArrayBuffer=function(){this.reset()};B.ArrayBuffer.prototype.append=function(a){var o=_n(this._buff.buffer,a),t=o.length,e;for(this._length+=a.byteLength,e=64;e<=t;e+=64)re(this._hash,It(o.subarray(e-64,e)));return this._buff=e-64<t?new Uint8Array(o.buffer.slice(e-64)):new Uint8Array(0),this};B.ArrayBuffer.prototype.end=function(a){var o=this._buff,t=o.length,e=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],n,s;for(n=0;n<t;n+=1)e[n>>2]|=o[n]<<(n%4<<3);return this._finish(e,t),s=Ie(this._hash),a&&(s=Me(s)),this.reset(),s};B.ArrayBuffer.prototype.reset=function(){return this._buff=new Uint8Array(0),this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this};B.ArrayBuffer.prototype.getState=function(){var a=B.prototype.getState.call(this);return a.buff=Cn(a.buff),a};B.ArrayBuffer.prototype.setState=function(a){return a.buff=bn(a.buff,!0),B.prototype.setState.call(this,a)};B.ArrayBuffer.prototype.destroy=B.prototype.destroy;B.ArrayBuffer.prototype._finish=B.prototype._finish;B.ArrayBuffer.hash=function(a,o){var t=gn(new Uint8Array(a)),e=Ie(t);return o?Me(e):e};async function wn(a){return new Promise((o,t)=>{const e=new B.ArrayBuffer,n=new FileReader;let s=0;n.onload=r=>{if(e.append(r.target.result),s+=r.target.result.byteLength,s===a.size){const m=e.end();o(m)}},n.onerror=r=>{t(null)},n.readAsArrayBuffer(a)})}const kn={class:"EditView-container"},Nn={class:"title"},En={class:"title-contain"},Sn={key:0},Vn={class:"footer-container",style:{flex:"auto"}},In=ye({__name:"EditView",setup(a){const o=V("editable"),t=Sa.uploadSingleUrl;async function e(v,i){const N=new URL(t),C=new FormData;C.append("image",v);try{const _=await fetch(N,{method:"post",body:C});if(!_.ok)return X({message:"上传出现错误",type:"error"}),null;const{code:R,ErrorMessage:ce,data:de}=await _.json();if(R==200)return de.imageURL;X({message:ce||"上传出现错误",type:"error"});return}catch{return X({message:"上传出现错误",type:"error"}),null}}async function n(v,i,N){try{const C=await wn(N[0]);if(C){const _=vn(N[0],C),R=await e(_),ce=mn(N[0].name);i({url:R,desc:ce||"图片"})}}catch{X({message:"处理图片出错",type:"error"})}}function s(v,i){r.value=!0}const r=V(!1),m=V(0),u=V({fileId:"",noteId:-1}),p=V({name:"",summary:"",text:"",categoryId:-1,isArchived:!1,tags:[]});function I(){p.value={name:"",summary:"",text:"",categoryId:-1,isArchived:!1,tags:[]}}const F={value:"id",checkStrictly:!0,label:"name",emitPath:!1},P=V([]),se=async()=>{if(!(P.value.length>0))try{const v=await Ea();if(v.code===200){const i=Ma(v.data,"id","parent_id","children",0);P.value=i}}catch(v){console.dir(v)}};async function W(){const{valid:v,errors:i}=await ut(Ua,p.value);if(!v)return X({message:i[0],type:"error"});const{code:N,ErrorMessage:C}=await xa(p.value);N==200?(X({message:"保存文章成功",type:"success"}),H()):X({message:C||"保存文章失败",type:"error"})}async function j(){try{const v={...p.value,...u.value},{valid:i,errors:N}=await ut(za,v);if(!i)return X({message:N[0],type:"error"});const{code:C,ErrorMessage:_}=await Ha(v);C==200?(X({message:"更新文章成功",type:"success"}),I(),H()):X({message:_||"更新文章失败",type:"error"})}catch{X({message:"更新文章失败",type:"error"})}}function q(){m.value===0?W():j()}function H(){r.value=!1}const K=V(""),M=V(!1),Z=V(),D=v=>{p.value.tags.splice(p.value.tags.indexOf(v),1)},S=()=>{M.value=!0,ve(()=>{Z.value.input.focus()})},L=()=>{K.value&&p.value.tags.push(K.value),M.value=!1,K.value=""};async function G(v){try{const{code:i,error:N,data:C}=await Da(v);i==200&&C.forEach(_=>{p.value.tags.push(_.tagName)})}catch{}}async function oe(v){try{const{code:i,ErrorMessage:N,data:C}=await Fa(v);if(i==200){const _=C;p.value.name=_.name,p.value.isArchived=_.isArchive==1,p.value.categoryId=_.categoryId,p.value.summary=_.summary,p.value.text=_.content,X({message:"获取文章内容成功",type:"success"})}else X({message:N||"获取文章内容失败",type:"error"})}catch{X({message:"获取文章内容失败",type:"error"})}}const Q=Ca(),ne=_a(),{navBarShapeInfo:f,tagViewShapeInfo:y}=wa(Q),k=v=>{v&&document.documentElement.style.setProperty("--editor-my-height",v+"px")};ka(()=>{const v=f.value.height||0,i=y.value.height||0;let N=700;N=ne.screenHeight-v-i-50,k(N)});const b=Na();return We(()=>{var v,i;se(),(v=b.params)!=null&&v.noteId&&((i=b.params)!=null&&i.fileId)&&(m.value=1,u.value={noteId:+b.params.noteId,fileId:b.params.fileId},G(u.value.noteId),oe(u.value.noteId))}),(v,i)=>{const N=J("v-md-editor"),C=Nt,_=$a,R=hn,ce=Aa,de=Oe,be=Va,Ce=Ia,De=Ta;return g(),x("div",kn,[te("h2",Nn,ae(m.value===0?"编辑文章":"更新文章"),1),A(N,{modelValue:p.value.text,"onUpdate:modelValue":i[0]||(i[0]=$=>p.value.text=$),mode:o.value,"disabled-menus":[],"left-toolbar":"undo redo clear | h bold italic strikethrough quote | ul ol table hr | link image code | save| todo-list",onUploadImage:i[1]||(i[1]=($,fe,Fe)=>h(ct)("center.uploadimage")(n)($,fe,Fe)),onSave:s},null,8,["modelValue","mode"]),A(De,{"lock-scroll":"",modal:"",class:"drawer-container",size:"50%",modelValue:r.value,"onUpdate:modelValue":i[8]||(i[8]=$=>r.value=$),direction:"btt"},{header:w(()=>[te("div",En,[te("h2",null,ae(m.value===0?"保存文章":"更新文章"),1)])]),default:w(()=>[te("div",null,[A(Ce,{model:p.value,ref:"formRef","label-width":"120px",class:"form-container"},{default:w(()=>[A(_,{label:"名称",prop:"name"},{default:w(()=>[A(C,{modelValue:p.value.name,"onUpdate:modelValue":i[2]||(i[2]=$=>p.value.name=$),maxlength:"100","show-word-limit":"",placeholder:"请输入名称"},null,8,["modelValue"])]),_:1}),A(_,{label:"摘要",prop:"summary"},{default:w(()=>[A(C,{type:"textarea",modelValue:p.value.summary,"onUpdate:modelValue":i[3]||(i[3]=$=>p.value.summary=$),maxlength:"200","show-word-limit":"",placeholder:"请输入摘要"},null,8,["modelValue"])]),_:1}),A(_,{label:"分类ID",prop:"categoryId"},{default:w(()=>[A(R,{"show-all-levels":!1,props:F,"model-value":p.value.categoryId,"onUpdate:modelValue":i[4]||(i[4]=$=>p.value.categoryId=$),options:P.value},{default:w(({node:$,data:fe})=>[te("span",null,ae(fe.name),1),$.isLeaf?ee("",!0):(g(),x("span",Sn," ("+ae(fe.children.length)+") ",1))]),_:1},8,["model-value","options"])]),_:1}),A(_,{label:"归档状态",prop:"isArchived"},{default:w(()=>[A(ce,{modelValue:p.value.isArchived,"onUpdate:modelValue":i[5]||(i[5]=$=>p.value.isArchived=$)},null,8,["modelValue"])]),_:1}),A(_,{label:"标签",prop:"tags"},{default:w(()=>[(g(!0),x(ge,null,_e(p.value.tags,$=>(g(),z(de,{key:$,closable:"","disable-transitions":!1,onClose:fe=>D($)},{default:w(()=>[he(ae($),1)]),_:2},1032,["onClose"]))),128)),M.value?(g(),z(C,{key:0,ref_key:"InputRef",ref:Z,modelValue:K.value,"onUpdate:modelValue":i[6]||(i[6]=$=>K.value=$),class:"w-20",size:"small",onKeyup:Et(L,["enter"]),onBlur:L},null,8,["modelValue"])):(g(),z(be,{key:1,class:"button-new-tag",size:"small",onClick:S},{default:w(()=>i[9]||(i[9]=[he(" + 新标签 ")])),_:1}))]),_:1})]),_:1},8,["model"])])]),footer:w(()=>[te("div",Vn,[A(be,{onClick:I},{default:w(()=>i[10]||(i[10]=[he("重置")])),_:1}),A(be,{onClick:H},{default:w(()=>i[11]||(i[11]=[he("取消")])),_:1}),A(be,{type:"primary",onClick:i[7]||(i[7]=$=>h(ct)("article.add")(q)())},{default:w(()=>i[12]||(i[12]=[he("提交")])),_:1})])]),_:1},8,["modelValue"])])}}}),Fn=Ba(In,[["__scopeId","data-v-513fa677"]]);export{Fn as default};
