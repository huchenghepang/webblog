import{l as T,z as k,bl as L,b1 as q,r as m,bm as A,b6 as B,w as C,b8 as E,b9 as z,o as S,c as D,E as R,d as i,f as u,p as y,g as f,F as h,v as I,i as M,H as V,u as x,G,af as F,x as O,k as U,a_ as Y,_ as $}from"./index-CKb1g0gP.js";import{A as j}from"./ArticleItem-DLn0cnZn.js";import{M as J}from"./Meteor-C7q4Z0iy.js";const K={class:"tags-container"},Q=["data-index","data-tagname"],W={class:"tag-number"},X={class:"tag-list-container"},Z=T({__name:"TagView",setup(ee){const{proxy:b}=k(),v=L(),{tagCounts:g}=q(v);async function N(){g.value.length===0&&await v.getAricleTagAndCategoryInfo()}const l=m(null),a=m({tagName:"",tagItemList:[]}),n=m({currentPage:1,pageSize:5,totalPages:0});function _(){a.value={tagName:"",tagItemList:[]},l.value=null,n.value={currentPage:1,pageSize:5,totalPages:0}}const d=E(async()=>{try{const{data:t,code:c}=await z({tagName:a.value.tagName,page:n.value.currentPage,pageSize:n.value.pageSize});if(c==200){const r=[...a.value.tagItemList,...t.data];a.value.tagItemList=r,n.value.totalPages=t.totalPages;const e=g.value.findIndex((o,te)=>o.tag_name===a.value.tagName);l.value=e}}catch{b.$message({text:"无法获取数据",type:"error"})}},500),w=A();function H(t){console.log(t);const c=t.target,{index:r,tagname:e}=c.dataset;l.value=Number(r),e&&e!==s.query.tagname&&(_(),w.push({name:"tag",query:{tagname:e}}))}function P(){a.value.tagName!==""&&n.value.currentPage<n.value.totalPages&&(n.value.currentPage++,d())}function p(){const t=Math.max(document.body.scrollHeight,document.documentElement.scrollHeight,document.body.offsetHeight,document.documentElement.offsetHeight,document.body.clientHeight,document.documentElement.clientHeight);window.pageYOffset+document.body.clientHeight+40>=t&&P()}const s=B();return C(()=>s.query.tagname,(t,c)=>{t&&typeof t=="string"&&(_(),a.value.tagName=t,d())}),S(()=>{window.scrollTo(0,0),document.addEventListener("scroll",p),N(),s.query.tagname&&typeof s.query.tagname=="string"&&(a.value.tagName=s.query.tagname,d())}),D(()=>{document.removeEventListener("scroll",p)}),(t,c)=>{const r=R("slideIn");return i(),u("div",K,[y(J,{number:20}),f("div",{class:"tag-cloud",onClick:H},[(i(!0),u(h,null,I(G(g),(e,o)=>(i(),u("span",{key:o,class:M(["tag",{"active-tag":l.value===o}]),"data-index":o,"data-tagname":e.tag_name},[V(x(e.tag_name),1),f("i",W,"("+x(e.note_count)+")",1)],10,Q))),128))]),f("div",X,[y(Y,{name:"item-transition"},{default:F(()=>[(i(!0),u(h,null,I(a.value.tagItemList,(e,o)=>O((i(),U(j,{style:{width:"100%"},key:e.note_id,content:e.summary,datetime:e.create_time,title:e.note_name,tags:e.tags,category:e.note_category,"file-id":e.file_id,toc:e.toc},null,8,["content","datetime","title","tags","category","file-id","toc"])),[[r]])),128))]),_:1})])])}}}),se=$(Z,[["__scopeId","data-v-4f80a773"]]);export{se as default};
